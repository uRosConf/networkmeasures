#' Network vulnerability per node
#' 
#' The \code{vulnerability}, according to Gol'dshtein (2004) and Latora et al (2005).
#'
#' @param g a graph
#' @param efficiency A precomputed efficiency for \code{g} (optional)
#'
#' @references Goldshtein, V., Koganov, G. A., & Surdutovich, G. I. (2004). Vulnerability and Hierarchy of Complex Networks. Cond-mat/0409298.
#' @references Latora, V., & Marchiori, M. (2005). Vulnerability and protection of infrastructure networks. Physical Review E, 71(1), 015103.
#' @export
vulnerability <- function(g, efficiency=NULL){
  e <- if(is.null(e)) efficiency(g) else efficiency
  nodes <- V(g)
  sapply(seq_along(nodes), function(i){
    h <- igraph::delete_edges(g, igraph::incident_edges(g,nodes[i])[[1]])
    1-efficiency(h)/e
  })
}


